@import "tailwindcss";
@import "./typography.css";
@import 'rehype-callouts/theme/obsidian';

@custom-variant dark (&:where([data-theme=dark], [data-theme=dark] *));

:root,
html[data-theme="light"] {
  --background: #fdfdfd;
  --foreground: #282728;
  --accent: #006cac;
  --muted: #e6e6e6;
  --border: #ece9e9;
}

/* html[data-theme="dark"] { */
/*   --background: #212737; */
/*   --foreground: #eaedf3; */
/*   --accent: #ff6b01; */
/*   --muted: #343f60; */
/*   --border: #ab4b08; */
/* } */
html[data-theme="dark"] {
  /* A deep slate blue that's softer than pure black */
  --background: #1a1f26; 
  /* Off-white with a hint of blue to reduce eye strain */
  --foreground: #d1d9e0; 
  --accent: #818cf8;
  /* Slightly lighter slate for cards/buttons */
  --muted: #2d3643; 
  /* Low-contrast border to keep things subtle */
  --border: #3f4e60; 
}

@theme inline {
  --font-app: var(--font-arimo);
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-accent: var(--accent);
  --color-muted: var(--muted);
  --color-border: var(--border);
}

@layer base {
  * {
    @apply border-border outline-accent/75;
    scrollbar-width: auto;
    scrollbar-color: var(--color-muted) transparent;
  }
  html {
    @apply overflow-y-scroll scroll-smooth;
  }
  body {
    @apply flex min-h-svh flex-col bg-background font-app text-foreground selection:bg-accent/75 selection:text-background;
    /* @apply leading-snug; */
  }
  a,
  button {
    @apply outline-offset-1 outline-accent focus-visible:no-underline focus-visible:outline-2 focus-visible:outline-dashed;
  }
  button:not(:disabled),
  [role="button"]:not(:disabled) {
    cursor: pointer;
  }
}

@utility max-w-app {
  @apply max-w-4xl;
}

@utility app-layout {
  @apply mx-auto w-full max-w-app px-4;
}

.active-nav {
  @apply underline decoration-wavy decoration-2 underline-offset-8;
}

/* Source: https://piccalil.li/blog/a-more-modern-css-reset/ */
/* Anything that has been anchored to should have extra scroll margin */
:target {
  scroll-margin-block: 1rem;
}

/* Force removal of quotes from all blockquotes */
.prose blockquote p::before,
.prose blockquote p::after,
blockquote p::before,
blockquote p::after {
  content: none !important;
}



.callout[data-callout="proof"] {
  --callout-color: 196, 196, 196;
  --callout-icon: lucide-lightbulb;
  font-family: "Computer Modern", serif;
}

/* 2. Fix the Line Gaps & Indentation */
/* We target the 'p' tag because Markdown wraps every line in one */
.callout[data-callout="proof"] .callout-content p {
  margin: 0 !important;             /* Kills the big vertical gaps */
  white-space: pre-wrap !important;  /* Preserves the leading spaces/tabs */
  display: block;                   /* Ensures each line is on its own row */
  min-height: 1.2em;                /* Keeps empty lines from collapsing */
}

/* 3. Handle Lists (if you use bullets/numbers) */
.callout[data-callout="proof"] li {
  margin-bottom: 0px !important;
}

/* /* Target paragraphs inside any list inside the proof callout */ */
/* .callout[data-callout="proof"] ol p, */
/* .callout[data-callout="proof"] ul p { */
/*   margin-top: 0 !important; */
/*   margin-bottom: 0 !important; */
/*   display: inline; /* This forces the paragraph to act like plain text */ */
/* } */
/**/
/* /* Tighten the spacing between the list items themselves */ */
/* .callout[data-callout="proof"] li { */
/*   margin-bottom: 0px !important; /* Adjust this number to your liking */ */
/* } */

.callout-content {
  white-space: pre-wrap;
}
/* "Reset" lists so they don't inherit the double-spacing behavior */
.callout-content :is(ol, ul, li) {
    white-space: inherit;
}

/* KILL THE INVISIBLE TEXT BUG */
.callout {
  mix-blend-mode: normal !important; /* This overrides the 'darken' bug */
  opacity: 1 !important;
}

/* Define the custom callout look */
.callout[data-callout="algo"] {
  --callout-color: 196, 196, 196;
  --callout-icon: lucide-code;
  font-family: "Computer Modern", serif;
}

/* Hide the bullets/numbers and remove gaps */
/* .callout[data-callout="algo"] ul,  */
.callout[data-callout="algo"] ul {
  list-style-type: none !important;
  margin: 0 !important;
  padding-left: 1.5rem !important; /* This creates your indentation */
  border-left: 1px solid rgba(196, 196, 196, 0.3); /* The vertical "scope" line */
}

/* Remove the line gaps between items */
.callout[data-callout="algo"] li {
  margin: 0 !important;
  padding: 0 !important;
}

/* Ensure math and text stay tight */
.callout[data-callout="algo"] li p {
  display: inline;
  margin: 0 !important;
}

/* The first level shouldn't have a border-left */
/* .callout[data-callout="algo"] > .callout-content > ul, */
.callout[data-callout="algo"] > .callout-content > ul {
  border-left: none;
  padding-left: 0 !important;
}

html[data-theme="dark"] .callout-content,
html[data-theme="dark"] .callout-content p {
  /* Option 1: Use your theme's off-white (Recommended) */
  color: var(--foreground) !important;
}

html[data-theme="dark"] .katex {
  /* Brightens the math symbols */
  color: var(--foreground);
  /* Optional: slightly increase the thickness of the symbols */
  -webkit-font-smoothing: antialiased;
  text-shadow: 0 0 0.5px var(--foreground); 
}

/* Target both inline and block math */
html[data-theme="dark"] .katex {
  color: #d1d9e0 !important;
}

/* target images with alt="left" */
img[alt~="left"] {
  float: left;
  margin-right: 1.5rem;
  margin-bottom: 1rem;
  /* Override Astro/Tailwind centering defaults */
  display: inline-block !important;
  margin-left: 0 !important;
}

/* target images with alt="right" */
img[alt~="right"] {
  float: right;
  margin-left: 1.5rem;
  margin-bottom: 1rem;
  /* Override Astro/Tailwind centering defaults */
  display: inline-block !important;
  margin-right: 0 !important;
}

/* Clearfix to prevent text from overlapping following sections */
p:has(img[alt~="left"]), 
p:has(img[alt~="right"]) {
  display: flow-root;
}




/* 1. The Container & Separator */
#refs.references {
  border-top: 1px solid #e5e7eb; /* The line separator */
  margin-top: 3rem;
  padding-top: 1.5rem;
  color: #6b7280;               /* Grey text */
  font-size: 0.85rem;           /* Smaller font */
  line-height: 1.6;
}

/* Add a "References" heading via CSS (Optional) */
#refs::before {
  content: "References";
  display: block;
  font-weight: bold;
  font-size: 1rem;
  color: #374151; /* Darker grey for the title */
  margin-bottom: 0.5rem;
}

/* 2. Alignment for Vancouver Numbers */
/* Vancouver usually puts the number in a div called .csl-left-margin */
.csl-bib-body {
  display: block;
}

.csl-entry {
  display: flex;                /* Keeps number and text on the same line */
}

.csl-left-margin {
  min-width: 1.5rem;            /* Ensures numbers don't push text around */
  font-weight: 600;
  color: #9ca3af;               /* Lighter grey for the number itself */
}

.csl-right-inline {
  flex: 1;                      /* Takes up the remaining width */
}
